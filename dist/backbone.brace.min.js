//     Backbone Brace - 2012/3/5
//     Copyright 2012 Atlassian Software Systems Pty Ltd
//     Licensed under the Apache License, Version 2.0
(function(){function e(a){return function d(e,f){var g,h=c.extend({},e),i;return e&&e.mixins&&(i=e.mixins,delete h.mixins),g=a.call(this,h,f),i&&c.each(e.mixins,function(a){b.Mixins.applyMixin(g,a)}),g.prototype.namedEvents&&b.Mixins.applyMixin(g,b.EventsMixinCreator.create(g.prototype.namedEvents)),g.prototype.namedAttributes&&b.Mixins.applyMixin(g,b.AttributesMixinCreator.create(g.prototype.namedAttributes)),g.extend=d,g}}function f(a,b){var d=a.prototype,e=b.prototype,f=d.set;e.set=function(a,b,d){var e,g=this.namedAttributes;if(g){c.isObject(a)||a==null?e=a:(e={},e[a]=b);for(var h in e)if(c.indexOf(g,h)<0)throw"Attribute '"+h+"' does not exist"}return f.apply(this,arguments)};var g=d.get;e.get=function(a){if(this.namedAttributes&&c.indexOf(this.namedAttributes,a)<0)throw"Attribute '"+a+"' does not exist";return g.apply(this,arguments)}}function g(a){var b=a.extend(),c=a.extend;return b.extend=e(c),b}function h(a){var b=g(a);return f(a,b),b}var a=this,b;typeof exports!="undefined"?b=exports:b=a.Brace={};var c=a._;!c&&typeof require!="undefined"&&(c=require("underscore"));var d=a.Backbone;!d&&typeof require!="undefined"&&(d=require("backbone")),b.Mixins={createMethodName:function(a,b){return a+b.charAt(0).toUpperCase()+b.substr(1)},applyMixin:function(a,b){c.forEach(c.keys(b),function(d){var e=a.prototype;if("initialize"===d){var f=e.initialize;e.initialize=function(){b.initialize.apply(this,arguments),f&&f.apply(this,arguments)};return}if("validate"===d){var g=e.validate;e.validate=function(){var a=b.validate.apply(this,arguments);if(a)return a;if(g)return g.apply(this,arguments)};return}if("defaults"===d){var h=e.defaults||(e.defaults={}),i=b[d];for(var j in i){if(h.hasOwnProperty(j))throw"Mixin error: class already has default '"+j+"' defined";h[j]=i[j]}return}if("namedAttributes"===d){if(!c.isArray(b[d]))throw"Expects namedAttributes member on mixin to be an array";e.namedAttributes||(e.namedAttributes=[]),e.namedAttributes=e.namedAttributes.concat(b[d]);return}if("namedEvents"===d){if(!c.isArray(b[d]))throw"Expects events member on mixin to be an array";e.namedEvents||(e.namedEvents=[]),e.namedEvents=e.namedEvents.concat(b[d]);return}if(e.hasOwnProperty(d))throw"Mixin error: class already has property '"+d+"' defined";e[d]=b[d]},this)}},b.AttributesMixinCreator={create:function(a){var d={};return c.indexOf(a,"id")===-1&&a.unshift("id"),c.each(a,function(a){var c=b.Mixins.createMethodName("set",a);d[c]=function(b,c){var d={};return d[a]=b,this.set(d,c),this};var e=b.Mixins.createMethodName("get",a);d[e]=function(){return this.get(a)}}),d}},b.EventsMixinCreator={create:function(a){var d={},e=function(a){var e=b.Mixins.createMethodName("on",a);d[e]=function(){return this.on.apply(this,[a].concat(c.toArray(arguments)))};var f=b.Mixins.createMethodName("trigger",a);d[f]=function(){return this.trigger.apply(this,[a].concat(c.toArray(arguments)))}};return c.each(a,c.bind(e,this)),d}},b.Model=h(d.Model),b.Collection=g(d.Collection),b.View=g(d.View),b.Router=g(d.Router)})()